<link rel="import" href="../msa-edition/msa-edition-mover.html"></link>
<style>
.msa-popup {
	position: absolute;
	top: 50px;
	left: 50px;
	background: white;
	padding: 15px;
	box-shadow: 1pt 1pt 2pt 1pt #aaa;
}
msa-popup-confirm {
	text-align: center;
}
msa-popup-confirm button {
	margin: 0px 10px 0px 10px;
}
</style>
<template id="msa-popup-confirm">
	<p class="text"></p>
	<button class="yes">Yes</button>
	<button class="no">No</button>
</template>
<template id="msa-popup-input">
	<p class="text"></p>
	<input type="text">
	<button class="ok">OK</button>
	<button class="cancel">Cancel</button>
</template>
<script>
(function(){

// popup /////////////////////////////////

var createPopup = function(dom) {
	if(typeof dom=="string") dom = document.createElement(dom)
	dom.classList.add("msa-popup")
	/*dom.hide = popupHide
	dom.show = popupShow
	dom.close = popupClose*/
	MsaEdition.makeMovable(dom)
	document.body.appendChild(dom)
	return dom
}

/*var popupHide = function() {
	this.style.display = 'none'
}

var popupShow = function() {
	this.style.display = ''
}

var popupClose = function() {
	this.remove()
}*/


// confirm /////////////////////////////////

var createConfirm = function(text, next) {
	var confirm = document.createElement("msa-popup-confirm")
	confirm.querySelector(".text").textContent = text
	confirm.querySelector(".yes").onclick = function() {
		next()
		confirm.remove()
	}
	confirm.querySelector(".no").onclick = function() {
		confirm.remove()
	}
	var popup = createPopup(confirm)
	confirm.querySelector(".yes").focus()
	return popup
}

Msa.registerElement("msa-popup-confirm", {
	template:"#msa-popup-confirm"
})

// input /////////////////////////////////

var createInput = function(text, next) {
	var input = document.createElement("msa-popup-input")
	var textDom = input.querySelector(".text")
	var inputDom = input.querySelector("input")
	textDom.textContent = text
	var validate = function() {
		next(inputDom.value)
		input.remove()
	}
	input.querySelector("button.ok").onclick = validate
	inputDom.onkeypress = function(e) {
		if(e.which == 13) validate()
	}
	input.querySelector("button.cancel").onclick = function() {
		input.remove()
	}
	var popup = createPopup(input)
	inputDom.focus()
	return popup
}

Msa.registerElement("msa-popup-input", {
	template:"#msa-popup-input"
})

// publish
if(!document.MsaPopup) document.MsaPopup = MsaPopup = {}
MsaPopup.create = createPopup
MsaPopup.createConfirm = createConfirm
MsaPopup.createInput = createInput

})()
</script>